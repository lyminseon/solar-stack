<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HUDIUS-SOLAR - íƒœì–‘ê´‘ MLOps í¬í„¸</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #0EA5E9;
            --primary-dark: #0284C7;  
            --secondary: #10B981;
            --secondary-dark: #059669;
            --accent: #F59E0B;
            --gray-50: #F8FAFC;
            --gray-100: #F1F5F9;
            --gray-200: #E2E8F0;
            --gray-600: #475569;
            --gray-800: #1E293B;
            --gray-900: #0F172A;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
            color: var(--gray-800);
            line-height: 1.6;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-block;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(14, 165, 233, 0.3);
        }
        
        .nav-link {
            color: var(--gray-600);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.2s ease;
            font-weight: 500;
            cursor: pointer;
        }
        
        .nav-link:hover, .nav-link.active {
            background: var(--primary);
            color: white;
        }
        
        .header-gradient {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }
        
        .service-frame {
            width: 100%;
            height: 80vh;
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            background: white;
        }
        
        .service-tabs {
            display: flex;
            gap: 8px;
            background: white;
            padding: 12px;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .tab-button {
            padding: 8px 16px;
            border: none;
            background: var(--gray-100);
            color: var(--gray-600);
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .tab-button.active {
            background: var(--primary);
            color: white;
        }
        
        .tab-button:hover:not(.active) {
            background: var(--gray-200);
        }

        .service-container {
            display: none;
            position: relative;
        }
        
        .service-container.active {
            display: block;
        }
        
        .logo {
            transition: transform 0.3s ease;
        }
        
        .logo:hover {
            transform: scale(1.05);
        }
        
        @media (max-width: 768px) {
            .logo { height: 3rem; }
        }
        
        @media (max-width: 640px) {
            .header-flex-col .logo { margin-bottom: 1rem; }
            .header-flex-col { text-align: center; }
        }
    </style>
</head>
<body>
    <header class="header-gradient text-white">
        <div class="container mx-auto px-6 py-8">
            <div class="flex flex-col md:flex-row md:justify-between md:items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <a href="/" class="flex items-center">
                    </a>
                    <div>
                        <h1 class="text-3xl md:text-4xl font-bold">
                            <a href="/" class="text-white hover:text-blue-100 transition-colors">
                                HUDIUS-SOLAR MLOps í¬í„¸
                            </a>
                        </h1>
                        <p class="text-lg md:text-xl opacity-90 mt-1">
                            ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ - í†µí•© ê´€ë¦¬ ë„êµ¬
                        </p>
                    </div>
                </div>
                
                <div class="flex items-center gap-4">
                    <div id="loginSection" class="{% if is_authenticated %}hidden{% endif %}">
                        <button id="loginBtn" onclick="showLoginModal()" class="btn-primary">
                            ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸
                        </button>
                    </div>
                    <div id="userSection" class="{% if not is_authenticated %}hidden{% endif %}">
                        <span class="text-white font-medium">ğŸ‘¤ {{ username|default:"ê´€ë¦¬ì" }}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤</span>
                        <button onclick="logout()" class="ml-2 text-red-200 hover:text-white">ë¡œê·¸ì•„ì›ƒ</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-6 py-8">
        <div class="service-tabs">
            <button class="tab-button active" onclick="showService('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
            <button class="tab-button" onclick="showService('airflow')">ğŸ”„ Airflow</button>
            <button class="tab-button" onclick="showService('mlflow')">ğŸ§  MLflow</button>
            <button class="tab-button" onclick="showService('grafana')">ğŸ“ˆ Grafana</button>
            <button class="tab-button" onclick="showService('superset')">ğŸ“Š Superset</button>
            <button class="tab-button" onclick="showService('keycloak')">ğŸ” Keycloak</button>
            <button class="tab-button" onclick="showService('minio')">ğŸ’¾ MinIO</button>
            <button class="tab-button" onclick="showService('prometheus')">ğŸ“¡ Prometheus</button>
        </div>

        <div id="dashboard" class="service-container active bg-white rounded-b-lg p-8">
            <h2 class="text-2xl font-bold mb-6">ì‹œìŠ¤í…œ ëŒ€ì‹œë³´ë“œ</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg">
                    <div class="text-3xl font-bold text-blue-600">99.9%</div>
                    <div class="text-gray-600">ì‹œìŠ¤í…œ ê°€ìš©ë¥ </div>
                </div>
                <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg">
                    <div class="text-3xl font-bold text-green-600">5.2%</div>
                    <div class="text-gray-600">ëª¨ë¸ MAPE</div>
                </div>
                <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 p-6 rounded-lg">
                    <div class="text-3xl font-bold text-yellow-600">1.67M</div>
                    <div class="text-gray-600">ëª¨ë¸ íŒŒë¼ë¯¸í„°</div>
                </div>
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg">
                    <div class="text-3xl font-bold text-purple-600">24h</div>
                    <div class="text-gray-600">ì˜ˆì¸¡ ë²”ìœ„</div>
                </div>
            </div>
            
            <div class="mt-8">
                <h3 class="text-xl font-semibold mb-4">ë¹ ë¥¸ ì‹œì‘</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="showService('airflow')" class="p-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-left transition-colors">
                        <div class="text-2xl mb-2">ğŸ”„</div>
                        <div class="font-medium">ì›Œí¬í”Œë¡œìš° ê´€ë¦¬</div>
                        <div class="text-sm text-gray-600">Airflowë¡œ ë°ì´í„° íŒŒì´í”„ë¼ì¸ í™•ì¸</div>
                    </button>
                    <button onclick="showService('mlflow')" class="p-4 bg-green-50 hover:bg-green-100 rounded-lg text-left transition-colors">
                        <div class="text-2xl mb-2">ğŸ§ </div>
                        <div class="font-medium">ì‹¤í—˜ ê´€ë¦¬</div>
                        <div class="text-sm text-gray-600">MLflowë¡œ ëª¨ë¸ ì‹¤í—˜ ì¶”ì </div>
                    </button>
                    <button onclick="showService('grafana')" class="p-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-left transition-colors">
                        <div class="text-2xl mb-2">ğŸ“ˆ</div>
                        <div class="font-medium">ëª¨ë‹ˆí„°ë§</div>
                        <div class="text-sm text-gray-600">Grafanaë¡œ ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§</div>
                    </button>
                </div>
            </div>
        </div>

        <div id="airflow" class="service-container">
            <div id="airflow-content-logged-in" class="bg-white rounded-b-lg overflow-hidden hidden">
                <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                    <h3 class="text-lg font-semibold">ğŸ”„ Apache Airflow - ì›Œí¬í”Œë¡œìš° ê´€ë¦¬</h3>
                    <div class="flex gap-2">
                        <button onclick="refreshService('airflow')" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">ìƒˆë¡œê³ ì¹¨</button>
                        <button onclick="openService('/airflow/')" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">ìƒˆ ì°½</button>
                    </div>
                </div>
                <iframe id="airflow-frame" src="/airflow/" class="service-frame" 
                        onload="hideLoader('airflow')" onerror="showError('airflow')"></iframe>
            </div>
            <div id="airflow-content-logged-out" class="{% if is_authenticated %}hidden{% endif %} text-center py-16 bg-white rounded-b-lg">
                <div class="bg-white rounded-lg p-8 max-w-md mx-auto">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                    <p class="text-gray-600 mb-6">Airflow ì›Œí¬í”Œë¡œìš°ë¥¼ ë³´ë ¤ë©´ ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <button onclick="showLoginModal()" class="btn-primary">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
            </div>
        </div>
        
        <div id="mlflow" class="service-container">
            <div id="mlflow-content-logged-in" class="bg-white rounded-b-lg overflow-hidden hidden">
                <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                    <h3 class="text-lg font-semibold">ğŸ§  MLflow - ë¨¸ì‹ ëŸ¬ë‹ ì‹¤í—˜ ê´€ë¦¬</h3>
                    <div class="flex gap-2">
                        <button onclick="refreshService('mlflow')" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">ìƒˆë¡œê³ ì¹¨</button>
                        <button onclick="openService('/mlflow/')" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">ìƒˆ ì°½</button>
                    </div>
                </div>
                <iframe id="mlflow-frame" src="/mlflow/" class="service-frame" 
                        onload="hideLoader('mlflow')" onerror="showError('mlflow')"></iframe>
            </div>
            <div id="mlflow-content-logged-out" class="{% if is_authenticated %}hidden{% endif %} text-center py-16 bg-white rounded-b-lg">
                <div class="bg-white rounded-lg p-8 max-w-md mx-auto">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                    <p class="text-gray-600 mb-6">MLflow ì‹¤í—˜ì„ ë³´ë ¤ë©´ ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <button onclick="showLoginModal()" class="btn-primary">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
            </div>
        </div>
        
        <div id="grafana" class="service-container">
            <div id="grafana-content-logged-in" class="bg-white rounded-b-lg overflow-hidden hidden">
                <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                    <h3 class="text-lg font-semibold">ğŸ“ˆ Grafana - ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§</h3>
                    <div class="flex gap-2">
                        <button onclick="refreshService('grafana')" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">ìƒˆë¡œê³ ì¹¨</button>
                        <button onclick="openService('/grafana/')" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">ìƒˆ ì°½</button>
                    </div>
                </div>
                <iframe id="grafana-frame" src="/grafana/" class="service-frame" 
                        onload="hideLoader('grafana')" onerror="showError('grafana')"></iframe>
            </div>
            <div id="grafana-content-logged-out" class="{% if is_authenticated %}hidden{% endif %} text-center py-16 bg-white rounded-b-lg">
                <div class="bg-white rounded-lg p-8 max-w-md mx-auto">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                    <p class="text-gray-600 mb-6">Grafana ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œë¥¼ ë³´ë ¤ë©´ ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <button onclick="showLoginModal()" class="btn-primary">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
            </div>
        </div>
        
        <div id="superset" class="service-container">
            <div id="superset-content-logged-in" class="bg-white rounded-b-lg overflow-hidden hidden">
                <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                    <h3 class="text-lg font-semibold">ğŸ“Š Apache Superset - ë°ì´í„° ì‹œê°í™”</h3>
                    <div class="flex gap-2">
                        <button onclick="refreshService('superset')" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">ìƒˆë¡œê³ ì¹¨</button>
                        <button onclick="openService('/superset/')" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">ìƒˆ ì°½</button>
                    </div>
                </div>
                <iframe id="superset-frame" src="/superset/" class="service-frame" 
                        onload="hideLoader('superset')" onerror="showError('superset')"></iframe>
            </div>
            <div id="superset-content-logged-out" class="{% if is_authenticated %}hidden{% endif %} text-center py-16 bg-white rounded-b-lg">
                <div class="bg-white rounded-lg p-8 max-w-md mx-auto">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                    <p class="text-gray-600 mb-6">Superset ë°ì´í„° ì‹œê°í™” ìë£Œë¥¼ ë³´ë ¤ë©´ ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <button onclick="showLoginModal()" class="btn-primary">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
            </div>
        </div>
        
        <div id="keycloak" class="service-container">
            <div id="keycloak-content-logged-in" class="bg-white rounded-b-lg overflow-hidden hidden">
                <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                    <h3 class="text-lg font-semibold">ğŸ” Keycloak - ì¸ì¦ ê´€ë¦¬</h3>
                    <div class="flex gap-2">
                        <button onclick="refreshService('keycloak')" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">ìƒˆë¡œê³ ì¹¨</button>
                        <button onclick="openService('/keycloak/')" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">ìƒˆ ì°½</button>
                    </div>
                </div>
                <iframe id="keycloak-frame" src="/keycloak/" class="service-frame" 
                        onload="hideLoader('keycloak')" onerror="showError('keycloak')"></iframe>
            </div>
            <div id="keycloak-content-logged-out" class="{% if is_authenticated %}hidden{% endif %} text-center py-16 bg-white rounded-b-lg">
                <div class="bg-white rounded-lg p-8 max-w-md mx-auto">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                    <p class="text-gray-600 mb-6">Keycloak ì¸ì¦ ì„¤ì •ì„ ê´€ë¦¬í•˜ë ¤ë©´ ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <button onclick="showLoginModal()" class="btn-primary">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
            </div>
        </div>
        
        <div id="minio" class="service-container">
            <div id="minio-content-logged-in" class="bg-white rounded-b-lg overflow-hidden hidden">
                <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                    <h3 class="text-lg font-semibold">ğŸ’¾ MinIO - ì˜¤ë¸Œì íŠ¸ ìŠ¤í† ë¦¬ì§€</h3>
                    <div class="flex gap-2">
                        <button onclick="refreshService('minio')" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">ìƒˆë¡œê³ ì¹¨</button>
                        <button onclick="openService('/minio/')" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">ìƒˆ ì°½</button>
                    </div>
                </div>
                <iframe id="minio-frame" src="/minio/" class="service-frame" 
                        onload="hideLoader('minio')" onerror="showError('minio')"></iframe>
            </div>
            <div id="minio-content-logged-out" class="{% if is_authenticated %}hidden{% endif %} text-center py-16 bg-white rounded-b-lg">
                <div class="bg-white rounded-lg p-8 max-w-md mx-auto">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                    <p class="text-gray-600 mb-6">MinIO ì˜¤ë¸Œì íŠ¸ ìŠ¤í† ë¦¬ì§€ë¥¼ ê´€ë¦¬í•˜ë ¤ë©´ ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <button onclick="showLoginModal()" class="btn-primary">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
            </div>
        </div>
        
        <div id="prometheus" class="service-container">
            <div id="prometheus-content-logged-in" class="bg-white rounded-b-lg overflow-hidden hidden">
                <div class="p-4 bg-gray-50 border-b flex justify-between items-center">
                    <h3 class="text-lg font-semibold">ğŸ“¡ Prometheus - ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§</h3>
                    <div class="flex gap-2">
                        <button onclick="refreshService('prometheus')" class="px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">ìƒˆë¡œê³ ì¹¨</button>
                        <button onclick="openService('/prometheus/')" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">ìƒˆ ì°½</button>
                    </div>
                </div>
                <iframe id="prometheus-frame" src="/prometheus/" class="service-frame" 
                        onload="hideLoader('prometheus')" onerror="showError('prometheus')"></iframe>
            </div>
            <div id="prometheus-content-logged-out" class="{% if is_authenticated %}hidden{% endif %} text-center py-16 bg-white rounded-b-lg">
                <div class="bg-white rounded-lg p-8 max-w-md mx-auto">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸ” ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
                    <p class="text-gray-600 mb-6">Prometheus ëª¨ë‹ˆí„°ë§ ë°ì´í„°ë¥¼ ë³´ë ¤ë©´ ê´€ë¦¬ì ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
                    <button onclick="showLoginModal()" class="btn-primary">ë¡œê·¸ì¸í•˜ê¸°</button>
                </div>
            </div>
        </div>

    </main>

    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900">ğŸ” Keycloak SSO ë¡œê·¸ì¸</h2>
                <p class="text-gray-600 mt-2">í†µí•© MLOps í”Œë«í¼ì— ì ‘ê·¼í•˜ë ¤ë©´ Keycloak ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤</p>
            </div>
            
            <div class="text-center">
                <div class="mb-6">
                    <p class="text-gray-600 mb-4">HUDIUS-SOLAR í†µí•© ì¸ì¦ ì‹œìŠ¤í…œì„ í†µí•´ ì•ˆì „í•˜ê²Œ ë¡œê·¸ì¸í•˜ì„¸ìš”</p>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                        <p class="text-blue-800 text-sm">
                            <strong>Keycloak SSO</strong>ë¥¼ ì‚¬ìš©í•˜ì—¬<br>
                            ëª¨ë“  ì„œë¹„ìŠ¤ì— ë‹¨ì¼ ê³„ì •ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                        </p>
                    </div>
                </div>
                
                <div id="loginError" class="hidden mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded">
                    ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
                </div>
                
                <div class="flex gap-4">
                    <button type="button" onclick="hideLoginModal()" 
                            class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                        ì·¨ì†Œ
                    </button>
                    <button type="button" onclick="initiateKeycloakLogin()" 
                            class="flex-1 btn-primary">
                        ğŸ” Keycloakìœ¼ë¡œ ë¡œê·¸ì¸
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // í˜„ì¬ í™œì„± ì„œë¹„ìŠ¤
        let currentService = 'dashboard';
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¸ì¦ ìƒíƒœ í™•ì¸
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
        });
        
        // Keycloak OIDC ì¸ì¦ ìƒíƒœ í™•ì¸
        async function checkAuthStatus() {
            try {
                // Djangoì˜ request.user ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ ìƒíƒœ í™•ì¸
                const response = await fetch('/api/check-auth/');
                const data = await response.json();
                
                if (data.authenticated) {
                    showAuthenticatedState(data.username);
                } else {
                    showUnauthenticatedState();
                }
            } catch (error) {
                console.error('ì¸ì¦ ìƒíƒœ í™•ì¸ ì˜¤ë¥˜:', error);
                showUnauthenticatedState();
            }
        }
        
        function showAuthenticatedState(username) {
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('userSection').classList.remove('hidden');
            
            // ë¡œê·¸ì¸ ì‹œ ì„œë¹„ìŠ¤ ì˜ì—­ ë³´ì´ê¸°
            const serviceContainers = document.querySelectorAll('.service-container');
            serviceContainers.forEach(container => {
                const loggedInContent = container.querySelector('[id$="-content-logged-in"]');
                const loggedOutContent = container.querySelector('[id$="-content-logged-out"]');
                if (loggedInContent) loggedInContent.classList.remove('hidden');
                if (loggedOutContent) loggedOutContent.classList.add('hidden');
            });

            // ì‚¬ìš©ìëª… ì—…ë°ì´íŠ¸
            const userSpan = document.querySelector('#userSection span');
            if (userSpan) {
                userSpan.textContent = `ğŸ‘¤ ${username}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤`;
            }

            // í™œì„± íƒ­ ì¬ì„¤ì • (ëŒ€ì‹œë³´ë“œê°€ ê¸°ë³¸)
            showService('dashboard');
        }
        
        function showUnauthenticatedState() {
            document.getElementById('loginSection').classList.remove('hidden');
            document.getElementById('userSection').classList.add('hidden');
            
            // ë¹„ë¡œê·¸ì¸ ì‹œ ì„œë¹„ìŠ¤ ì˜ì—­ ë³´ì´ê¸°
            const serviceContainers = document.querySelectorAll('.service-container');
            serviceContainers.forEach(container => {
                const loggedInContent = container.querySelector('[id$="-content-logged-in"]');
                const loggedOutContent = container.querySelector('[id$="-content-logged-out"]');
                if (loggedInContent) loggedInContent.classList.add('hidden');
                if (loggedOutContent) loggedOutContent.classList.remove('hidden');
            });

            // ëŒ€ì‹œë³´ë“œë§Œ í™œì„±í™”
            showService('dashboard');
        }
        
        function showService(serviceName) {
            // ëª¨ë“  ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.service-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // ì„ íƒëœ ì„œë¹„ìŠ¤ í‘œì‹œ ë° íƒ­ í™œì„±í™”
            document.getElementById(serviceName).classList.add('active');
            document.querySelector(`.tab-button[onclick="showService('${serviceName}')"]`).classList.add('active');
            
            currentService = serviceName;
            
            // iframeì´ ìˆëŠ” ì„œë¹„ìŠ¤ì˜ ê²½ìš° ë¡œë”© ìƒíƒœ ì´ˆê¸°í™”
            const iframe = document.getElementById(serviceName + '-frame');
            if (iframe) {
                const loader = document.getElementById(serviceName + '-loader');
                if (loader) loader.classList.remove('hidden');
            }
        }
        
        function openService(serviceUrl) {
            // ìƒˆ íƒ­ì—ì„œ ì„œë¹„ìŠ¤ ì—´ê¸°
            window.open(serviceUrl, '_blank');
        }
        
        function refreshService(serviceName) {
            // iframe ìƒˆë¡œê³ ì¹¨
            const iframe = document.getElementById(serviceName + '-frame');
            const loader = document.getElementById(serviceName + '-loader');
            const error = document.getElementById(serviceName + '-error');
            
            if (iframe) {
                // ë¡œë” í‘œì‹œ, ì—ëŸ¬ ìˆ¨ê¸°ê¸°
                if (loader) loader.classList.remove('hidden');
                if (error) error.classList.add('hidden');
                
                // iframe ìƒˆë¡œê³ ì¹¨
                iframe.src = iframe.src;
            }
        }
        
        function hideLoader(serviceName) {
            // ë¡œë”© ì™„ë£Œ ì‹œ ë¡œë” ìˆ¨ê¸°ê¸°
            const loader = document.getElementById(serviceName + '-loader');
            if (loader) {
                loader.classList.add('hidden');
            }
        }
        
        function showError(serviceName) {
            // ì—ëŸ¬ ë°œìƒ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
            const loader = document.getElementById(serviceName + '-loader');
            const error = document.getElementById(serviceName + '-error');
            
            if (loader) loader.classList.add('hidden');
            if (error) error.classList.remove('hidden');
        }
        
        function showLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('loginError').classList.add('hidden');
        }
        
        function hideLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
        }
        
        // Keycloak OIDC ë¡œê·¸ì¸ ì´ˆê¸°í™”
        function initiateKeycloakLogin() {
            try {
                // Keycloak OIDC ë¡œê·¸ì¸ URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
                const keycloakLoginUrl = '/auth/login/';
                window.location.href = keycloakLoginUrl;
            } catch (error) {
                console.error('Keycloak ë¡œê·¸ì¸ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                document.getElementById('loginError').classList.remove('hidden');
                document.getElementById('loginError').textContent = 'Keycloak ë¡œê·¸ì¸ì„ ì´ˆê¸°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            }
        }
        
        // Keycloak OIDC ë¡œê·¸ì•„ì›ƒ
        async function logout() {
            try {
                // Keycloak OIDC ë¡œê·¸ì•„ì›ƒ URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
                const keycloakLogoutUrl = '/auth/logout/';
                window.location.href = keycloakLogoutUrl;
            } catch (error) {
                console.error('Keycloak ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ ê°•ì œë¡œ ë¹„ì¸ì¦ ìƒíƒœë¡œ ë³€ê²½
                showUnauthenticatedState();
            }
        }
        
        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                hideLoginModal();
            }
        });
        
        // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('loginModal').addEventListener('click', function(event) {
            if (event.target === this) {
                hideLoginModal();
            }
        });
    </script>
</body>
</html>