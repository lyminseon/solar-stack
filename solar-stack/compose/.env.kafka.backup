# ── 기본 설정 ─────────────────────────────
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=hudius2020!

# Grafana root URL (subpath 기반: /grafana/)
GF_SERVER_ROOT_URL=https://www.greenfesco.com/grafana/
GF_SERVER_SERVE_FROM_SUB_PATH=true

# ── Database (Postgres 사용) ──────────────
GF_DATABASE_TYPE=postgres
GF_DATABASE_HOST=postgres:5432
GF_DATABASE_NAME=solar_db
GF_DATABASE_USER=hudius
GF_DATABASE_PASSWORD=hudius2020!

# ── 로그/모니터링 ─────────────────────────
GF_LOG_MODE=console
GF_LOG_LEVEL=info

# ── OIDC (Keycloak) ──────────────────────
GF_AUTH_GENERIC_OAUTH_ENABLED=true
GF_AUTH_GENERIC_OAUTH_NAME=Keycloak
GF_AUTH_GENERIC_OAUTH_ALLOW_SIGN_UP=true
GF_AUTH_GENERIC_OAUTH_CLIENT_ID=grafana
GF_AUTH_GENERIC_OAUTH_CLIENT_SECRET=grafana-secret-key-2024
GF_AUTH_GENERIC_OAUTH_SCOPES=openid profile email
GF_AUTH_GENERIC_OAUTH_AUTH_URL=https://www.greenfesco.com/keycloak/realms/solar/protocol/openid-connect/auth
GF_AUTH_GENERIC_OAUTH_TOKEN_URL=https://www.greenfesco.com/keycloak/realms/solar/protocol/openid-connect/token
GF_AUTH_GENERIC_OAUTH_API_URL=https://www.greenfesco.com/keycloak/realms/solar/protocol/openid-connect/userinfo

# 기본 로그인 방법은 Keycloak 우선, 로컬 admin fallback
GF_AUTH_DISABLE_LOGIN_FORM=false
GF_AUTH_DISABLE_SIGNOUT_MENU=false

# ── Role mapping (Keycloak → Grafana) ─────
# Keycloak realm role 매핑 (예: admin → Grafana Admin)
GF_AUTH_GENERIC_OAUTH_ROLE_ATTRIBUTE_PATH=contains(realm_access.roles[*], 'admin') && 'Admin' || contains(realm_access.roles[*], 'viewer') && 'Viewer' || 'Editor'
